window.SiteOriginPremium=window.SiteOriginPremium||{},SiteOriginPremium.ImageOverlay=function(i,t,e){var a=jQuery;this.image=i,this.options=t,this.init=function(){this.imageContainer||(this.imageContainer=a(i).parent().closest("div"),this.createChildren(),this.addEventListeners()),setTimeout(this.layoutChildren.bind(this),150)},this.createChildren=function(){if(this.overlayContainer=a('<div class="so-premium-image-overlay-container"></div>'),this.overlay=a('<div class="so-premium-image-overlay"></div>'),this.overlayBackground=a('<div class="so-premium-image-overlay-background"></div>'),this.overlayBackground.css({backgroundColor:t.overlay_color,opacity:t.overlay_opacity}),this.overlay.append(this.overlayBackground),void 0===this.options.overlay_text)var i=this.image.title;else if("object"==typeof this.options.overlay_text)i=void 0===this.options.overlay_text[e]?this.image.title:this.options.overlay_text[e];else i=this.options.overlay_text;this.overlayText=a('<div class="so-premium-image-overlay-text">'+i+"</div>"),a(this.image).css("pointerEvents","none");var o={margin:"0",padding:this.options.text_padding};t.hasOwnProperty("font")&&t.font&&(o.fontFamily=t.font.family,t.font.hasOwnProperty("weight")&&(o.fontWeight=t.font.weight),t.font.hasOwnProperty("url")&&a("head").append('<link rel="stylesheet" media="all" href="'+t.font.url+'"/>')),t.hasOwnProperty("text_size")&&(o.fontSize=t.text_size),t.hasOwnProperty("text_color")&&(o.color=t.text_color),o.textAlign=t.text_align,this.overlayText.css(o),this.overlay.append(this.overlayText),this.overlay.css("opacity",0),this.overlayContainer.append(this.overlay),this.overlayContainer.css({overflow:"hidden"}),this.imageContainer.find("> a").length?this.imageContainer.find("> a").append(this.overlayContainer):this.imageContainer.append(this.overlayContainer)},this.layoutChildren=function(){var i=a(this.image),t=this.imageContainer.position();t.width=Math.min(this.imageContainer.width(),i.width()),t.height=Math.min(this.imageContainer.height(),i.height());var e={top:Math.max(0,i.position().top)+"px",left:Math.max(0,i.position().left)+"px",width:t.width+"px",height:t.height+"px",maxWidth:this.imageContainer.css("maxWidth"),maxHeight:this.imageContainer.css("maxHeight")};this.overlayContainer.css(e),this.isDesktop=window.matchMedia("(min-width: "+this.options.responsive_breakpoint+")").matches;var o={top:0,left:0,width:t.width,height:t.height,maxWidth:i.css("maxWidth"),maxHeight:i.css("maxHeight")},s=this.options.overlay_size;switch(this.options.overlay_position){case"top":o.height=t.height*s;break;case"right":o.width=t.width*s,o.left=t.width-o.width;break;case"bottom":o.height=t.height*s,o.top=t.height-o.height;break;case"left":o.width=t.width*s}o.top+="px",o.width+="px",o.height+="px",o.left+="px",this.overlay.css(o);var n=this.overlay.outerHeight(),r=this.overlayText.outerHeight(),h={};switch(this.options.text_position){case"top":h.top=0;break;case"middle":h.top=.5*(n-r)+"px";break;case"bottom":h.top=n-r+"px"}this.overlayText.css(h),this.isDesktop||"always"!==this.options.touch_show_trigger?this.isDesktop&&(this.isDesktop&&"always"===this.options.desktop_show_trigger?this.overlay.css("opacity",1):(this.options.overlay_animation&&"none"!==this.options.overlay_animation&&(this.animationTimeline=anime.timeline({autoplay:!1}),this.animationTimeline.add(this.getAnimationOptions(this.overlay.get(0),this.options.overlay_animation,{position:this.options.overlay_position}))),this.options.text_animation&&"none"!==this.options.text_animation&&(this.animationTimeline||(this.animationTimeline=anime.timeline({autoplay:!1})),this.animationTimeline.add(this.getAnimationOptions(this.overlayText.get(0),this.options.text_animation))))):(this.overlay.css("opacity",1),this.overlayText.css("opacity",1)),this.isDesktop?"hover"===this.options.desktop_show_trigger&&(this.imageContainer.on("mouseenter",function(){this.isDesktop&&this.showOverlay()}.bind(this)),this.imageContainer.on("mouseleave",function(){this.hideOverlay()}.bind(this))):"touch"===this.options.touch_show_trigger&&this.imageContainer.on("touchend",function(){this.toggleOverlay()}.bind(this))},this.getAnimationOptions=function(i,t,e){var o={targets:i,changeBegin:function(){this.overlayContainer.css("overflow","hidden")}.bind(this)},s=a(i);switch(t){case"fade":o.easing="linear",o.duration=250,o.opacity=[0,1];break;case"slide":switch(o.easing="easeOutExpo",o.duration=500,s.css("opacity",1),e.hasOwnProperty("position")?e.position:"top"){case"top":o.translateY=[-s.outerHeight(),0];break;case"right":o.translateX=[s.parent().outerWidth(),0];break;case"bottom":o.translateY=[s.parent().outerHeight(),0];break;case"left":o.translateX=[-s.outerWidth(),0]}break;case"slide_left":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateX=[20,0];break;case"slide_right":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateX=[-20,0];break;case"slide_up":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateY=[10,0];break;case"slide_down":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateY=[-10,0];break;case"drop":o.easing="linear",o.duration=250,o.opacity=[0,1],o.scale=[1.1,1],o.changeBegin=function(){this.overlayContainer.css("overflow","visible")}.bind(this)}return o},this.addEventListeners=function(){this.imageContainer.is(".sow-masonry-grid-item,.sow-image-grid-image")&&this.imageContainer.closest(".sow-masonry-grid,.sow-image-grid-wrapper").on("layoutComplete",this.layoutChildren.bind(this)),a(window).on("resize",this.layoutChildren.bind(this))},this.showOverlay=function(){this.showingOverlay||(this.showingOverlay=!0,this.animationTimeline?("reverse"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.began&&!this.animationTimeline.completed||this.animationTimeline.play()):this.overlay.css("opacity",1))},this.hideOverlay=function(){this.showingOverlay&&(this.showingOverlay=!1,this.animationTimeline?("normal"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.completed&&(this.animationTimeline.completed=!1,this.animationTimeline.play())):this.overlay.css("opacity",0))},this.toggleOverlay=function(){if(this.animationTimeline)this.animationTimeline.began&&"normal"===this.animationTimeline.direction?this.hideOverlay():this.showOverlay();else{var i=1===this.overlay.css("opacity")?0:1;this.overlay.css("opacity",i)}},i.complete?this.init():(i.addEventListener("load",function(){this.init()}.bind(this)),i.addEventListener("error",(function(){console.log("Could not setup Image Overlay. Image loading failed.")})))},SiteOriginPremium.createImageOverlays=function(i){i(".so-widget-sow-image, .so-widget-sow-image-grid, .so-widget-sow-simple-masonry").each((function(t,e){var a=i(e);if(a.data("overlay-enabled")){var o=a.data("overlay-settings");i(e).find("img").each((function(t,e){e.title&&(e.classList.contains("jetpack-lazy-image")?i(e).on("jetpack-lazy-loaded-image",(function(i){new SiteOriginPremium.ImageOverlay(i.target,o,t)})):new SiteOriginPremium.ImageOverlay(e,o,t))}))}}))},jQuery((function(i){SiteOriginPremium.createImageOverlays(i),window.sowb&&i(window.sowb).on("setup_widgets",(function(){SiteOriginPremium.createImageOverlays(i)}))}));