var SOPremiumFontSelectorPlugin=function(t,n){var o,e=jQuery,i="so_premium_font_format",r=soPremiumFonts.font_modules;function a(){new SOPremiumFontsImporter(t.contentDocument).importFonts()}function f(){o.attr("data-placeholder",soPremiumFonts.placeholder_text),o.webfontselector({modules:r,useVariants:!0,useSubsets:!1,showInherit:!1});var n,e=o.siblings(".chosen-container").find(".chosen-search input");e.on("mouseup",(function(){n||(n=setTimeout((function(){e.trigger("focus"),n=null}),100))})),o.on("font_change",(function(n,o,e){o&&o.hasOwnProperty("font")&&o.font?t.execCommand("soPremiumApplyFont",i,o):t.execCommand("soPremiumRemoveFont",i)}))}t.on("init",(function(){t.formatter.register(i,{inline:"span",classes:"so-premium-web-font",attributes:{"data-web-font-module":"%fontModule","data-font-info":"%fontInfo"},styles:{"font-family":"%fontFamily","font-weight":"%fontWeight"},remove:"all"}),a()})),t.on("NodeChange",(function(n){if(t.formatter&&o){var e=n.element,i="",r="";if(e.hasAttribute("data-font-info")){var a=JSON.parse(e.getAttribute("data-font-info"));i=a.font,r=a.hasOwnProperty("variant")?a.variant:""}o.webfontselector("update",i,r)}})),t.addCommand("soPremiumApplyFont",(function(n,o){var e=o.font?"'"+o.font+"'":"";e+=o.category?", "+o.category:"";var i="regular";if(o.variant){var r=o.variant.match(/(\d*)(\w*)/);r.length>1&&r[1]&&(i=r[1])}t.formatter.apply(n,{fontFamily:e,fontWeight:i,fontInfo:JSON.stringify(o),fontModule:o.module}),a()})),t.addCommand("soPremiumRemoveFont",(function(n){t.formatter.remove(n,{fontFamily:null,fontModule:null},null,!0)})),t.addButton("so-premium-font-selector",{type:"selectbox",icon:!1,onPostRender:function(t){if((o=e(t.control.$el)).is(":visible"))f();else var n=setInterval((function(){o.is(":visible")&&(f(),clearInterval(n),n=null)}),500)}})};(0,window.jQuery)(document).ready((function(){window.tinymce&&tinymce.PluginManager.add("so-premium-font-selector",(function(t,n){new SOPremiumFontSelectorPlugin(t,n)}))}));