(function(a){'use strict';var b="WooCommerceVariationGalleryImages",c={modalHeightAuto:'1'};function d(d,e){this.element=d,this.settings=a.extend({},c,e),this._defaults=c,this.trans=this.settings.trans,this._name=b,this.init()}a.extend(d.prototype,{init:function(){this.window=a(window),this.documentHeight=a(document).height(),this.windowHeight=this.window.height(),this.product={},this.elements={},this.singleImagesSlider=!1,this.galleryThumbnailsSlider=!1,this.getInitialGalleryHTML(),this.getSimpleImages(),this.getVariationImages(),this.thumbnailClick(),this.fullscreen()},getInitialGalleryHTML:function(){this.settings.initalImageContainer=a(this.settings.imageContainer).html(),this.settings.initalGalleryImagesContainer=a(this.settings.galleryImagesContainer).html()},getSimpleImages:function(){var b=this;if(a('.woocommerce-hidden-non-variable-product').length<1)return;b.renderImages()},getVariationImages:function(){var b=this;a(document).on('woocommerce_variation_has_changed','.variations_form',function(a){b.renderImages()}),b.settings.overrideDefaultImageGallery=="1"&&setTimeout(function(){a('.variations_form').trigger('woocommerce_variation_has_changed')},500)},renderImages:function(){var b=this,e=a('input[name="variation_id"]'),c=e.val(),d=a('input[name="product_id"]').val(),f;if(c==""&&d=="")return;f=a('.variations_form').serialize(),a(b.settings.galleryImagesContainer).html(''),a(b.settings.imageContainer).html('<div class="woocommerce-gallery-images-main-carousel-loader"><svg width="44" height="44" viewBox="0 0 44 44" xmlns="http://www.w3.org/2000/svg" stroke="'+b.settings.loaderColor+'"><g fill="none" fill-rule="evenodd" stroke-width="2"><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /><animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /></circle><circle cx="22" cy="22" r="1"><animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite" /><animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite" /></circle></g> </svg></div>'),setTimeout(function(){jQuery.ajax({url:b.settings.ajax_url,type:'post',dataType:'JSON',data:{action:'woocommerce_get_gallery_images',variation_id:c,product_id:d,formData:f},success:function(h){var e,d,n,m,k,i,j,f,l,c,g,o,r,p,q;if(!h.status)return;e='<div class="woocommerce-gallery-images-main-carousel woocommerce-gallery-images-main-position-'+b.settings.galleryThumbnailsPosition+'">',d='<div class="woocommerce-gallery-images-gallery-carousel woocommerce-gallery-images-gallery-position-'+b.settings.galleryThumbnailsPosition+'">',n=b.settings.singleImageColums,m=100/n,k=b.settings.singleImageMarginRight,i=b.settings.galleryThumbnailsColums,j=100/i,f=b.settings.galleryThumbnailsMarginRight,b.settings.galleryThumbnailsPosition!="horizontal"&&(f=0),a.each(h.images,function(c,a){e+='<div class="woocommerce-gallery-images-main-carousel-cell" style="width: '+m+'% !important;margin-right: '+k+'px !important;">'+a.full+'</div>',d+='<a href="#" class="woocommerce-gallery-images-gallery-carousel-cell" style="width: '+j+'% !important;margin-right: '+f+'px !important;border-color: '+b.settings.thumbnailBorderColor+' !important;">'+a.thumbnail+'</a>'}),e+='</div>',d+='</div>',b.settings.galleryThumbnailsEnable=="0"&&(d=""),b.settings.imageContainer==b.settings.galleryImagesContainer?a(b.settings.imageContainer).html(e+d):(a(b.settings.imageContainer).html(e),a(b.settings.galleryImagesContainer).html(d)),b.singleImagesSlider=a('.woocommerce-gallery-images-main-carousel').flickity(b.settings.singleImagesOptions),b.settings.galleryThumbnailsPosition=="horizontal"?b.galleryThumbnailsSlider=a('.woocommerce-gallery-images-gallery-carousel').flickity(b.settings.galleryThumbnailsOptions):(l=a('.woocommerce-gallery-images-main-carousel').height(),c=a('.woocommerce-gallery-images-gallery-carousel'),c.css('max-height',l+'px'),g=c.find('.woocommerce-gallery-images-gallery-carousel-cell'),o=b.singleImagesSlider.data('flickity'),r=c.position().top,p=g.height(),q=c.height(),b.singleImagesSlider.on('select.flickity',function(){var a,b;c.find('.is-nav-selected').removeClass('is-nav-selected'),a=g.eq(o.selectedIndex).addClass('is-nav-selected'),b=a.position().top+c.scrollTop()-(q+p)/3,c.animate({scrollTop:b})})),a('.woocommerce-gallery-images-main-carousel').append('<a href="#" style="border-color: '+b.settings.fullscreenColor+';"class="woocommerce-gallery-images-main-carousel-fullscreen"><svg style="fill: '+b.settings.fullscreenColor+';" viewBox="0 0 32 32"><path d="M15,20,7,28h5v4H0V20H4v5l8-8Zm5-5,8-8v5h4V0H20V4h5l-8,8Z"></path></svg></a>'),b.settings.singleImagesOptions.zoom=="1"&&a('.woocommerce-gallery-images-main-carousel img').each(function(b,c){a(this).wrap('<span style="display:inline-block"></span>').css('display','block').parent().zoom({duration:20})})},error:function(a,c,b){console.log('An Error Occured: '+a.status+' '+b+'! Please contact System Administrator!')}})},b.settings.fakeLoadingTime)},thumbnailClick:function(){var b=this;a(b.settings.galleryImagesContainer).on('click','.woocommerce-gallery-images-gallery-carousel-cell',function(e){var c,d;e.preventDefault(),c=a(this),a('.woocommerce-gallery-images-gallery-carousel-cell').removeClass('is-selected'),c.addClass('is-selected'),d=a(this).index(),b.singleImagesSlider.flickity('select',d)})},fullscreen:function(){var c=a('.woocommerce-gallery-images-fullscreen-overlay'),b;if(c.length<1)return;b=this,b.fullscreenOpen=!1,a(document).on('click','.woocommerce-gallery-images-main-carousel-fullscreen, .woocommerce-gallery-images-main-carousel-cell.is-selected',function(a){a.preventDefault(),b.openFullscreen(),b.fullscreenOpen=!0}),a(document).on('click','.woocommerce-gallery-images-fullscreen-overlay, .woocommerce-gallery-images-fullscreen-container',function(c){c.preventDefault(),a('.woocommerce-gallery-images-fullscreen-container, .woocommerce-gallery-images-fullscreen-overlay').fadeOut(),b.fullscreenOpen=!1})},openFullscreen:function(){var b=a('.woocommerce-gallery-images-main-carousel-cell.is-selected img').attr('src');a('.woocommerce-gallery-images-fullscreen-container').html('<img src="'+b+'" alt="">'),a('.woocommerce-gallery-images-fullscreen-container, .woocommerce-gallery-images-fullscreen-overlay').fadeIn()}}),a.fn[b]=function(c){return this.each(function(){a.data(this,"plugin_"+b)||a.data(this,"plugin_"+b,new d(this,c))})},a(document).ready(function(){a("body").WooCommerceVariationGalleryImages(woocommerce_gallery_images_options)})})(jQuery)